---
title: "Genomics Functions"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{genomics-functions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(levinmisc)
```

<!-- WARNING - This vignette is generated by {fusen} from /dev/flat_genomics_functions.Rmd: do not edit by hand -->

# Plotting

These convenience functions are useful for creating plots from GWAS summary statistics.


## Manhattan plots

The `gg_manhattan_df` function is used to create Manhattan plots. This function can optionally annotated the plot with additional information (eg. gene name, rsid) by using the `annotation_df` amd `label_col` arguments.
    

  

```{r example-gg_manhattan_df}
#' \dontrun{
#' gg_manhattan_df()
#' }
```

  

  

## QQ plots

The `gg_qq_df` function can be used to generate a qq plot to visually evaluate for test statistic inflation, and calculate lambda GC to quantify any inflation.
    

  

```{r example-gg_qq_df}
#' \dontrun{
#' gg_qq_df()
#' }
```

  

  

# Annotation

These convenience functions are useful for adding additional information to GWAS summary stastics.


## Add rsids

This function can be used rapidly add rsids to GWAS summary statistics by chromosome:position.
    

  

```{r example-annotate_rsids}
#' \dontrun{
#' annotate_rsids()
#' }
```

  

  

# GWAS Meta-analysis

GWAS summary statistics from multiple studies can be combined using meta-analysis. The following functions are useful for orchestrating GWAS meta-analysis using R.


## METAL

METAL <https://github.com/statgen/METAL> is a common command-line tool for performing GWAS meta-analysis. The following functions can be used to configure and run METAL directly from R.


### Configure METAL

    

  

```{r example-metal_config}
#' \dontrun{
#' metal_config()
#' }
```

  

### Run METAL

    

  

```{r example-metal_run}
#' \dontrun{
#' metal_run(config_file = "config.txt", metal_path = "/path/to/metal_binary")
#' }
```

  

  
  

# Colocalization

Colocalization is a technique for evaluating the evidence supporting the presence of shared causal variant(s) at a given locus across two or more traits. Several methods of colocalization have been described, which generally leverage GWAS summary statistics across multiple traits. The methods use either proportional or enumeration approaches, which make different assumptions and test different hypotheses.


## HyPrColoc

This function is a convenience wrapper around [hyprcoloc::hyprcoloc()] that takes a dataframe as input, and performs mutli-trait colocalization using HyPrColoc, a Bayesian enumeration colocalization method which makes the assumption of a single causal variant at the locus. Details of the HyPrColoc method are described in Foley et al. (Nature Communications 2021): <https://doi.org/10.1038/s41467-020-20885-8>.


  

```{r example-hyprcoloc_df}
#' \dontrun{
#' hyprcoloc_df(gwas_results_df)
#' }
```

  

  
  

# Gene-based Testing

GWAS summary statistics can be used to perform gene-based testing for associations with the trait/phenotype of interest, rather than SNP/variant-level associations found in GWAS.


## MAGMA

This function provides a wrapper to MAGMA, which performs gene-based testing from GWAS summary statistics. Details of MAGMA described in de Leeuw et al. (PLoS Cumputational Biology 2015; <https://doi.org/10.1371/journal.pcbi.1004219>). The MAGMA binary and reference files are available from the Complex Trait Genetics lab (<https://ctg.cncr.nl/software/magma>).
    

  

```{r example-magmar}
#' \dontrun{
#' magmar()
#' 
```

  

    


